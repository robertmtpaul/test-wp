'use strict';var map,geo,markers=[],poly,top_window=window.top,top_iframe=top_window.document;
function builderMapsProInit(){geo=new top_window.google.maps.Geocoder;map=new top_window.google.maps.Map(top_iframe.getElementById("map-canvas"),{center:new top_window.google.maps.LatLng(-34.397,150.644),draggable:!0,scrollwheel:!0,zoomControl:!0,scaleControl:!0,mapTypeControl:!0});poly=new top_window.google.maps.Polyline({});poly.setMap(map);builderMapsPro_update_map_preview();var a=jQuery,f=a("#markers",top_iframe).find(".tb_repeatable_field"),g=f.length,e=function(c){setTimeout(function(){var b=
a(f[c]),d=b.find("textarea.latlng");d=""!==d.val()?d.val():b.find(".address .tb_lb_option_child").val();b.attr("data-marker_index",c);builderMapsPro_add_new_marker(d,b.find(".title .tb_lb_option_child").val(),b.find(".tb_uploader_input").val(),c,b,function(){++c;c<g&&e(c)})},100)};0<g&&e(0)}
function builderMapsPro_update_map_preview(){if("undefined"!==typeof geo){var a=jQuery;geo.geocode({address:a("#map_center",top_iframe).val()},function(a,e){e===top_window.google.maps.GeocoderStatus.OK&&map.setCenter(a[0].geometry.location)});var f={zoom:parseInt(a("#zoom_map",top_iframe).val()),mapTypeId:top_window.google.maps.MapTypeId[a("#type_map",top_iframe).val()],styles:builderMapsPro.styles[a("#style_map",top_iframe).val()],disableDefaultUI:"yes"===a("#disable_map_ui",top_iframe).val(),draggable:!1,
scrollwheel:!1};map.setOptions(f);poly.setOptions({geodesic:"yes"===a("#map_polyline_geodesic",top_iframe).val(),strokeColor:a("#map_polyline_color",top_iframe).val(),strokeOpacity:a("#map_polyline_color",top_iframe).parent().next(".color_opacity").val()||1,strokeWeight:a("#map_polyline_stroke",top_iframe).val(),visible:"yes"===a("#map_polyline",top_iframe).val()})}}
function builderMapsPro_add_new_marker(a,f,g,e,c,b){if(null===a||""===a.trim())return null;var d=a.match(/^([-+]?[1-8]?\d(\.\d+)?|90(\.0+)?),?\s*([-+]?180(\.0+)?|[-+]?((1[0-7]\d)|([1-9]?\d))(\.\d+)?)(,\d+z)?$/),h=function(a){poly&&poly.getPath().push(a);markers[e]=new top_window.google.maps.Marker({map,position:a,icon:g});g||markers[e].setIcon();if(""!==f.trim()){var k=new top_window.google.maps.InfoWindow({content:'<div class="maps-pro-content">'+f+"</div>"});top_window.google.maps.event.addListener(markers[e],
"click",function(){k.open(map,markers[e])})}c.find("textarea.latlng").val(a.lat()+","+a.lng());b&&b()};jQuery.isArray(d)?h(new top_window.google.maps.LatLng(d[1],d[4])):geo.geocode({address:a},function(a,b){b===top_window.google.maps.GeocoderStatus.OK&&h(a[0].geometry.location);return null})}function builderMapsPro_remove_marker(a){void 0!==markers[a]&&(markers[a].setMap(null),markers[a]=null)}
(function(a){var f=null;tb_app.Constructor.map_pro={render:function(g,e){null===f&&(f=!0,top_window.Themify.LoadCss(builderMapsPro.admin_css,builderMapsPro.v));var c=ThemifyBuilderCommon.Lightbox.$lightbox,b=document.createElement("div"),d=document.createElement("div"),h=document.createElement("div");b.id="map-preview";d.id="map-canvas";h.className="tb_group_element_static";h.textContent=g.help;b.appendChild(d);b.appendChild(e.create([g.options]));b.appendChild(h);c.on("change.map_pro","#map_center, #zoom_map, #type_map, #style_map, #disable_map_ui, #map_polyline, #map_polyline_geodesic, #map_polyline_stroke, #map_polyline_color",
function(b){b.isTrigger&&!a("#map_polyline_color",top_iframe).is(b.target)||builderMapsPro_update_map_preview()}).on("change.map_pro","#markers .tb_lb_option_child",function(){var b=a(this).closest(".tb_repeatable_field"),c=void 0===b.data("marker_index")?markers.length:b.data("marker_index");b.attr("data-marker_index",c);builderMapsPro_remove_marker(c);markers[c]=builderMapsPro_add_new_marker(b.find(".address .tb_lb_option_child").val(),b.find(".title .tb_lb_option_child").val(),b.find(".image .tb_lb_option_child").val(),
c,b)}).on("click.map_pro","#markers .tb_delete_row",function(){builderMapsPro_remove_marker(a(this).closest(".tb_repeatable_field").data("marker_index"))});Themify.body.one("themify_builder_lightbox_close",function(a){c.off(".map_pro");map=poly=geo=null;markers=[]});setTimeout(function(){"object"!==typeof top_window.google||null===top_window.google?top_window.Themify.LoadAsync("//maps.google.com/maps/api/js?v=3.exp&key="+builderMapsPro.key,function(){var a=setInterval(function(){"object"===typeof top_window.google&&
null!==top_window.google&&"object"===typeof top_window.google.maps&&(clearInterval(a),builderMapsProInit())},300)},!1,"3",function(){return"object"===typeof top_window.google&&null!==top_window.google&&"object"===typeof top_window.google.maps}):builderMapsProInit()},10);return b}}})(jQuery);
